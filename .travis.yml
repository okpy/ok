sudo: required
dist: trusty
language: python
services:
  - docker
  - mysql
python:
    - "3.5"
addons:
  apt:
    packages:
    - mysql-server-5.6 # Should 5.7 really but 5.6 is easier to install
    - mysql-client-core-5.6
    - mysql-client-5.6
env:
  global:
    - OK_ENV=test
    - DATABASE_URL=mysql://root@127.0.0.1:3306/ok_test
  matrix:
      - USE_DOCKER=true
      - USE_DOCKER=false
install:
    - pip install -r requirements.txt
    - mysql -u root -e 'create database ok_test;'
script:
  - make test
  - make docker-build
after_success:
  - pip install python-coveralls
  - coveralls
notifications:
  email: false
  slack:
    on_success: never
    on_failure: always
    on_pull_requests: false
    secure: mGqCgRCFMB89AKsYVOZI79sifCFOLaQkuY3rvFKMitpD1GYQQpkBbZ9Z1SWi0VQV63oOKTQBrPCeDSwhZMaJA/dCZZIuz6e9nkVyJJUIrqAuH9PjgQr6FM4FkKzVLpHdPnXIikAvUAKiPRzzj8z4KO1EohBRR/xb2/4TpoWrkSA=
